#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🚀 푸시 전 전체 MCP 테스트 실행 중..."
echo "⏱️  이 과정은 2-3분 정도 소요될 수 있습니다."

# 개발 서버가 실행 중인지 확인
if ! curl -s http://localhost:3000 > /dev/null 2>&1; then
  echo "⚠️  개발 서버가 실행되지 않았습니다."
  echo "💡 일부 테스트는 건너뛸 수 있습니다."
fi

# 전체 MCP 테스트 실행
npm run test:mcp:ci

if [ $? -ne 0 ]; then
  echo "❌ MCP 테스트 실패. 푸시를 중단합니다."
  echo "💡 해결 방법:"
  echo "   1. npm run test:mcp:enhanced - 기본 테스트 확인"
  echo "   2. npm run test:mcp:integration - 연동 테스트 확인"
  echo "   3. npm run test:mcp:website - 웹사이트 테스트 확인"
  echo "   4. npm run test:mcp:performance - 성능 테스트 확인"
  exit 1
fi

echo "✅ 모든 MCP 테스트 통과. 푸시를 진행합니다."



