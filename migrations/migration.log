[0;34m[2025-09-13 01:18:58][0m Starting VideoPlanet CineGenius v3 Migration
[0;34m[2025-09-13 01:18:58][0m =============================================
[0;34m[2025-09-13 01:18:58][0m Testing database connection...
[0;32m[SUCCESS][0m Database connection successful
[0;34m[2025-09-13 01:18:59][0m Validating migration prerequisites...
[0;34m[2025-09-13 01:19:00][0m Current data counts:
[0;34m[2025-09-13 01:19:00][0m   - Users: 55
[0;32m[SUCCESS][0m Prerequisites validation completed
[0;34m[2025-09-13 01:19:00][0m Creating database backup...
[0;32m[SUCCESS][0m Backup created: /home/winnmedia/videoprompt/migrations/backups/backup_20250913_011900.sql
[0;34m[2025-09-13 01:19:11][0m Executing CineGenius v3 schema migration...
BEGIN
CREATE TABLE
CREATE INDEX
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:66: NOTICE:  Added generation_metadata to VideoAsset table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:66: NOTICE:  Added quality_score to VideoAsset table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:86: NOTICE:  Added permissions to ShareToken table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  Added comment_type to Comment table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  Added feedback_data to Comment table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  Added rating to Comment table
DO
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:172: ERROR:  functions in index predicate must be marked IMMUTABLE
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:194: ERROR:  current transaction is aborted, commands ignored until end of transaction block
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:211: ERROR:  current transaction is aborted, commands ignored until end of transaction block
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:228: ERROR:  current transaction is aborted, commands ignored until end of transaction block
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:250: ERROR:  current transaction is aborted, commands ignored until end of transaction block
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:293: ERROR:  current transaction is aborted, commands ignored until end of transaction block
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:307: ERROR:  current transaction is aborted, commands ignored until end of transaction block
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:318: ERROR:  current transaction is aborted, commands ignored until end of transaction block
ROLLBACK
CineGenius v3 Schema Migration completed successfully!
Added fields:
  - VideoAsset: generation_metadata, quality_score
  - ShareToken: permissions
  - Comment: comment_type, feedback_data, rating
Added 7 performance indexes
Added 3 data integrity constraints
Created MigrationLog table for version control
[0;32m[SUCCESS][0m Migration completed successfully in 3s
[0;34m[2025-09-13 01:19:14][0m Validating migration results...
[0;34m[2025-09-13 01:19:35][0m Starting VideoPlanet CineGenius v3 Migration
[0;34m[2025-09-13 01:19:35][0m =============================================
[0;34m[2025-09-13 01:19:35][0m Testing database connection...
[0;32m[SUCCESS][0m Database connection successful
[0;34m[2025-09-13 01:19:36][0m Validating migration prerequisites...
[0;34m[2025-09-13 01:19:38][0m Current data counts:
[0;34m[2025-09-13 01:19:38][0m   - Users: 55
[0;32m[SUCCESS][0m Prerequisites validation completed
[0;34m[2025-09-13 01:19:38][0m Creating database backup...
[0;32m[SUCCESS][0m Backup created: /home/winnmedia/videoprompt/migrations/backups/backup_20250913_011938.sql
[0;34m[2025-09-13 01:19:48][0m Executing CineGenius v3 schema migration...
BEGIN
CREATE TABLE
CREATE INDEX
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:66: NOTICE:  Added generation_metadata to VideoAsset table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:66: NOTICE:  Added quality_score to VideoAsset table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:86: NOTICE:  Added permissions to ShareToken table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  Added comment_type to Comment table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  Added feedback_data to Comment table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  Added rating to Comment table
DO
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:193: NOTICE:  Added provider constraint to VideoAsset table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:210: NOTICE:  Added status constraint to VideoAsset table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:227: ERROR:  check constraint "sharetoken_role_check" of relation "ShareToken" is violated by some row
CONTEXT:  SQL statement "ALTER TABLE "ShareToken" 
        ADD CONSTRAINT sharetoken_role_check 
        CHECK (role IN ('viewer', 'editor', 'admin', 'owner'))"
PL/pgSQL function inline_code_block line 8 at SQL statement
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:249: ERROR:  current transaction is aborted, commands ignored until end of transaction block
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:292: ERROR:  current transaction is aborted, commands ignored until end of transaction block
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:306: ERROR:  current transaction is aborted, commands ignored until end of transaction block
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:317: ERROR:  current transaction is aborted, commands ignored until end of transaction block
ROLLBACK
CineGenius v3 Schema Migration completed successfully!
Added fields:
  - VideoAsset: generation_metadata, quality_score
  - ShareToken: permissions
  - Comment: comment_type, feedback_data, rating
Added 7 performance indexes
Added 3 data integrity constraints
Created MigrationLog table for version control
[0;32m[SUCCESS][0m Migration completed successfully in 3s
[0;34m[2025-09-13 01:19:52][0m Validating migration results...
[0;34m[2025-09-13 01:20:21][0m Starting VideoPlanet CineGenius v3 Migration
[0;34m[2025-09-13 01:20:21][0m =============================================
[0;34m[2025-09-13 01:20:21][0m Testing database connection...
[0;32m[SUCCESS][0m Database connection successful
[0;34m[2025-09-13 01:20:22][0m Validating migration prerequisites...
[0;34m[2025-09-13 01:20:23][0m Current data counts:
[0;34m[2025-09-13 01:20:23][0m   - Users: 55
[0;32m[SUCCESS][0m Prerequisites validation completed
[0;34m[2025-09-13 01:20:23][0m Creating database backup...
[0;32m[SUCCESS][0m Backup created: /home/winnmedia/videoprompt/migrations/backups/backup_20250913_012023.sql
[0;34m[2025-09-13 01:20:29][0m Executing CineGenius v3 schema migration...
BEGIN
CREATE TABLE
CREATE INDEX
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:66: NOTICE:  Added generation_metadata to VideoAsset table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:66: NOTICE:  Added quality_score to VideoAsset table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:86: NOTICE:  Added permissions to ShareToken table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  Added comment_type to Comment table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  Added feedback_data to Comment table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  Added rating to Comment table
DO
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:193: NOTICE:  Added provider constraint to VideoAsset table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:210: NOTICE:  Added status constraint to VideoAsset table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:232: NOTICE:  Migrated legacy role values in ShareToken
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:232: NOTICE:  Added role constraint to ShareToken table
DO
INSERT 0 1
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:297: NOTICE:  Migration validation successful. All expected fields present.
DO
UPDATE 0
UPDATE 10
COMMIT
CineGenius v3 Schema Migration completed successfully!
Added fields:
  - VideoAsset: generation_metadata, quality_score
  - ShareToken: permissions
  - Comment: comment_type, feedback_data, rating
Added 7 performance indexes
Added 3 data integrity constraints
Created MigrationLog table for version control
[0;32m[SUCCESS][0m Migration completed successfully in 3s
[0;34m[2025-09-13 01:20:33][0m Validating migration results...
[0;32m[SUCCESS][0m Migration validation completed successfully
[0;34m[2025-09-13 01:20:36][0m Generating migration report...
[0;32m[SUCCESS][0m Migration report generated: /home/winnmedia/videoprompt/migrations/migration_report_20250913_012036.txt
[0;32m[SUCCESS][0m Migration completed successfully!
[0;32m[SUCCESS][0m Database is now ready for CineGenius v3
[0;34m[2025-09-13 01:20:36][0m Backup created at: [0;34m[2025-09-13 01:20:23][0m Creating database backup...
[0;32m[SUCCESS][0m Backup created: /home/winnmedia/videoprompt/migrations/backups/backup_20250913_012023.sql
/home/winnmedia/videoprompt/migrations/backups/backup_20250913_012023.sql
[0;34m[2025-09-13 01:22:25][0m Starting VideoPlanet CineGenius v3 Migration
[0;34m[2025-09-13 01:22:25][0m =============================================
[0;34m[2025-09-13 01:22:25][0m Testing database connection...
[0;32m[SUCCESS][0m Database connection successful
[0;34m[2025-09-13 01:22:26][0m Validating migration prerequisites...
[0;34m[2025-09-13 01:22:27][0m Current data counts:
[0;34m[2025-09-13 01:22:27][0m   - Users: 55
[0;32m[SUCCESS][0m Prerequisites validation completed
[0;34m[2025-09-13 01:22:27][0m Creating database backup...
[0;32m[SUCCESS][0m Backup created: /home/winnmedia/videoprompt/migrations/backups/backup_20250913_012227.sql
[0;34m[2025-09-13 01:22:31][0m Executing CineGenius v3 schema migration...
BEGIN
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:27: NOTICE:  relation "MigrationLog" already exists, skipping
CREATE TABLE
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:30: NOTICE:  relation "idx_migration_log_applied_at" already exists, skipping
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:31: NOTICE:  relation "idx_migration_log_status" already exists, skipping
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:66: NOTICE:  generation_metadata already exists in VideoAsset table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:66: NOTICE:  quality_score already exists in VideoAsset table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:86: NOTICE:  permissions already exists in ShareToken table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  comment_type already exists in Comment table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  feedback_data already exists in Comment table
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:135: NOTICE:  rating already exists in Comment table
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:145: NOTICE:  relation "idx_prompt_cinegenius_version" already exists, skipping
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:149: NOTICE:  relation "idx_videoasset_status_provider" already exists, skipping
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:154: NOTICE:  relation "idx_videoasset_quality_score" already exists, skipping
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:158: NOTICE:  relation "idx_comment_type_target" already exists, skipping
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:163: NOTICE:  relation "idx_comment_rating" already exists, skipping
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:167: NOTICE:  relation "idx_sharetoken_role_target" already exists, skipping
CREATE INDEX
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:171: NOTICE:  relation "idx_sharetoken_active" already exists, skipping
CREATE INDEX
DO
DO
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:232: NOTICE:  Migrated legacy role values in ShareToken
DO
INSERT 0 0
psql:/home/winnmedia/videoprompt/migrations/001_cinegenius_v3_schema_upgrade.sql:297: NOTICE:  Migration validation successful. All expected fields present.
DO
UPDATE 0
UPDATE 0
COMMIT
CineGenius v3 Schema Migration completed successfully!
Added fields:
  - VideoAsset: generation_metadata, quality_score
  - ShareToken: permissions
  - Comment: comment_type, feedback_data, rating
Added 7 performance indexes
Added 3 data integrity constraints
Created MigrationLog table for version control
[0;32m[SUCCESS][0m Migration completed successfully in 4s
[0;34m[2025-09-13 01:22:36][0m Validating migration results...
[0;32m[SUCCESS][0m Migration validation completed successfully
[0;34m[2025-09-13 01:22:39][0m Generating migration report...
[0;32m[SUCCESS][0m Migration report generated: /home/winnmedia/videoprompt/migrations/migration_report_20250913_012239.txt
[0;32m[SUCCESS][0m Migration completed successfully!
[0;32m[SUCCESS][0m Database is now ready for CineGenius v3
[0;34m[2025-09-13 01:22:39][0m Backup created at: [0;34m[2025-09-13 01:22:27][0m Creating database backup...
[0;32m[SUCCESS][0m Backup created: /home/winnmedia/videoprompt/migrations/backups/backup_20250913_012227.sql
/home/winnmedia/videoprompt/migrations/backups/backup_20250913_012227.sql
